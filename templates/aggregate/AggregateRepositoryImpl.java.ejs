package <%= packageName %>.<%= moduleName %>.infrastructure.database.repositories;

import org.springframework.stereotype.Repository;
import lombok.RequiredArgsConstructor;
import <%= packageName %>.<%= moduleName %>.domain.models.entities.<%= rootEntity.name %>;
import <%= packageName %>.<%= moduleName %>.domain.repositories.<%= rootEntity.name %>Repository;
import <%= packageName %>.<%= moduleName %>.infrastructure.database.entities.<%= rootEntity.name %>Jpa;
import <%= packageName %>.<%= moduleName %>.infrastructure.database.mappers.<%= aggregateName %>Mapper;
import java.util.List;
import java.util.Optional;
import java.util.stream.Collectors;

/**
 * <%= rootEntity.name %>RepositoryImpl
 * Implementation of <%= rootEntity.name %>Repository using JPA
 */
@Repository
@RequiredArgsConstructor
public class <%= rootEntity.name %>RepositoryImpl implements <%= rootEntity.name %>Repository {
    
    private final <%= rootEntity.name %>JpaRepository jpaRepository;
    private final <%= aggregateName %>Mapper mapper;
    
    @Override
    public <%= rootEntity.name %> save(<%= rootEntity.name %> <%= rootEntity.fieldName %>) {
        <%= rootEntity.name %>Jpa jpa = mapper.toJpa(<%= rootEntity.fieldName %>);
        <%= rootEntity.name %>Jpa saved = jpaRepository.save(jpa);
        return mapper.toDomain(saved);
    }
    
    @Override
    public Optional<<%= rootEntity.name %>> findById(<%= rootEntity.fields[0].javaType %> id) {
        return jpaRepository.findById(id)
                .map(mapper::toDomain);
    }
    
    @Override
    public List<<%= rootEntity.name %>> findAll() {
        return jpaRepository.findAll().stream()
                .map(mapper::toDomain)
                .collect(Collectors.toList());
    }
    
    @Override
    public void deleteById(<%= rootEntity.fields[0].javaType %> id) {
        jpaRepository.deleteById(id);
    }
    
    @Override
    public boolean existsById(<%= rootEntity.fields[0].javaType %> id) {
        return jpaRepository.existsById(id);
    }
}
